// sell.js
import { getAuth } from "firebase/auth";

// ✅ EmailJS credentials
const EMAILJS_SERVICE_ID = "service_8pofbon";
const EMAILJS_TEMPLATE_LISTING_ID = "template_ed7sx4o";
const EMAILJS_PUBLIC_KEY = "mqnVOPu2ysfQu72il";

document.addEventListener("DOMContentLoaded", () => {
  const sellForm = document.getElementById("sellForm");

  if (!sellForm) return;

  sellForm.addEventListener("submit", async (e) => {
    e.preventDefault();

    const auth = getAuth();
    const user = auth.currentUser;

    const title = document.getElementById("listingTitle").value;
    const description = document.getElementById("listingDescription").value;
    const price = document.getElementById("listingPrice").value;
    const crypto = document.getElementById("listingCrypto").value;

    if (!user) {
      alert("You must be signed in to create a listing.");
      return;
    }

    if (title.length < 50) {
      alert("Title must be at least 50 characters long.");
      return;
    }

    try {
      const emailData = {
        from_name: user.email,
        listing_title: title,
        listing_description: description,
        listing_price: price,
        listing_crypto: crypto,
        reply_to: user.email,
      };

      // ✅ Send listing review email
      const response = await emailjs.send(
        EMAILJS_SERVICE_ID,
        EMAILJS_TEMPLATE_LISTING_ID,
        emailData,
        EMAILJS_PUBLIC_KEY
      );

      console.log("Listing review email sent:", response);
      alert("Your listing has been submitted for review!");
      sellForm.reset();
    } catch (error) {
      console.error("Error sending listing email:", error);
      alert("Error submitting your listing. Please try again.");
    }
  });
});
// sell.js
import { getAuth } from "firebase/auth";

// ✅ EmailJS credentials
const EMAILJS_SERVICE_ID = "service_8pofbon";
const EMAILJS_TEMPLATE_LISTING_ID = "template_ed7sx4o";
const EMAILJS_PUBLIC_KEY = "mqnVOPu2ysfQu72il";

document.addEventListener("DOMContentLoaded", () => {
  const sellForm = document.getElementById("sellForm");

  if (!sellForm) return;

  sellForm.addEventListener("submit", async (e) => {
    e.preventDefault();

    const auth = getAuth();
    const user = auth.currentUser;

    const title = document.getElementById("listingTitle").value;
    const description = document.getElementById("listingDescription").value;
    const price = document.getElementById("listingPrice").value;
    const crypto = document.getElementById("listingCrypto").value;

    if (!user) {
      alert("You must be signed in to create a listing.");
      return;
    }

    if (title.length < 50) {
      alert("Title must be at least 50 characters long.");
      return;
    }

    try {
      const emailData = {
        from_name: user.email,
        listing_title: title,
        listing_description: description,
        listing_price: price,
        listing_crypto: crypto,
        reply_to: user.email,
      };

      // ✅ Send listing review email
      const response = await emailjs.send(
        EMAILJS_SERVICE_ID,
        EMAILJS_TEMPLATE_LISTING_ID,
        emailData,
        EMAILJS_PUBLIC_KEY
      );

      console.log("Listing review email sent:", response);
      alert("Your listing has been submitted for review!");
      sellForm.reset();
    } catch (error) {
      console.error("Error sending listing email:", error);
      alert("Error submitting your listing. Please try again.");
    }
  });
});
